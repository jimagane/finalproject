
  loadMarkers = (map) => {
    let markers = [];
    for (let i = 0; i < this.state.filteredResults.length; i++) {
      let position = this.state.filteredResults[i].location;
      let title = this.state.filteredResults[i].title;
      let info = this.state.filteredResults[i].info;
      let reviews = this.state.filteredResults[i].reviews;
      let id = this.state.filteredResults[i].id;
      let marker = new window.google.maps.Marker({
        position: position,
        title: title,
        info: info,
        reviews: reviews,
        map: map,
        animation: window.google.maps.Animation.DROP,
        id: id
      });
      marker.addListener('click', function() {
        loadYelpEmbedScript();
        populateInfoWindow(this, largeInfowindow);
      });
      markers.push(marker);
    }

    this.setState({markers: markers})


    let largeInfowindow = new window.google.maps.InfoWindow();

    function loadYelpEmbedScript()  {
      let container = document.getElementById('yelpReview');
      let scriptYelp = document.createElement('script');
      scriptYelp.src= "https://www.yelp.com/embed/widgets.js";
      scriptYelp.async= true;
      container.appendChild(scriptYelp);
    }

    function populateInfoWindow(marker, infowindow) {
      let infocontent = renderToString(<InfoWindowContent result={marker}/>);
      if (infowindow.marker !== marker) {
        infowindow.setContent('');
        infowindow.marker = marker;
        infowindow.addListener('closeclick', function() {
          infowindow.marker = null;
        });
        infowindow.setContent(infocontent);
        infowindow.open(map, marker);
      }
    }


  }

  clearMarkers = (markers) => {
    for (let c=0; c<this.state.markers.length; c++) {
      markers[c].setMap(null);
    }
    console.log(this.state.filteredResults);
    this.setState({markers: []});
    this.loadMarkers(this.state.map);
  }
